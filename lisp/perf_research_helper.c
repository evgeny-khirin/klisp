///-------------------------------------------------------------------
/// Copyright (c) 2009-2011 by Evgeny Khirin.
///-------------------------------------------------------------------
///-------------------------------------------------------------------
/// File    : perf_research_helper.cpp
/// Author  : Evgeny Khirin <>
/// Description : Tests for performance research.
///-------------------------------------------------------------------

#include "perf_research.h"

//--------------------------------------------------------------------------
// Public function
//--------------------------------------------------------------------------
long sum_fn(long x, long y) {
  return x + y;
}

//--------------------------------------------------------------------------
// lisp function 1
//--------------------------------------------------------------------------
long lisp_fun_proto_1(vm_t * vm, long nargs, long * args) {
  if (nargs != 2) {
    lisp_signal(g_invalid_args_count, long_to_term(nargs));
  }
  return sum_fn(args[0], args[1]);
}

//--------------------------------------------------------------------------
// lisp function 2
//--------------------------------------------------------------------------
long lisp_fun_proto_2(long nargs, long * args) {
  if (nargs != 2) {
    lisp_signal(g_invalid_args_count, long_to_term(nargs));
  }
  return sum_fn(args[0], args[1]);
}

//--------------------------------------------------------------------------
// Public function
//--------------------------------------------------------------------------
long pr_void_fn(long x) {
  return x;
}

//--------------------------------------------------------------------------
// Public function
//--------------------------------------------------------------------------
long STDCALL pr_void_stdcall_fn(long x) {
  return x;
}

//--------------------------------------------------------------------------
// Public function
//--------------------------------------------------------------------------
void pr_void_varg_fn(size_t n, ...) {
}

//--------------------------------------------------------------------------
// Public function
//--------------------------------------------------------------------------
pr_void_fn_ptr pr_get_void_fn() {
  return pr_void_fn;
}

//--------------------------------------------------------------------------
// Public function
//--------------------------------------------------------------------------
void pr_throw_longjmp() {
  longjmp(g_pr_jmp_buf, 1);
}

//--------------------------------------------------------------------------
// Public function
//--------------------------------------------------------------------------
long pr_throw_retcode() {
  return -1;
}
